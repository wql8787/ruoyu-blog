<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <title>å‘½è¿æ˜Ÿç›˜</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ==================== 1. åŸºç¡€ç¯å¢ƒ ==================== */
        body {
            margin: 0; min-height: 100vh;
            background-color: #0f0b15;
            display: flex; justify-content: center; align-items: center;
            font-family: "Noto Serif SC", "Cinzel", serif;
            overflow-x: hidden; overflow-y: auto; perspective: 1600px;
        }

        .nebula-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: 
                radial-gradient(circle at 50% 120%, rgba(100, 50, 160, 0.3) 0%, transparent 60%),
                radial-gradient(circle at 20% 20%, rgba(200, 150, 50, 0.05) 0%, transparent 40%),
                #0f0b15;
            z-index: -2;
        }

        .dust {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('https://www.transparenttextures.com/patterns/stardust.png');
            opacity: 0.4; animation: drift 60s linear infinite;
            z-index: -1; pointer-events: none;
        }
        @keyframes drift { from { background-position: 0 0; } to { background-position: 100px 100px; } }

        /* ==================== 2. æ°´æ™¶çƒ ==================== */
        .crystal-container {
            position: absolute; top: 50px; left: 50%; transform: translateX(-50%);
            width: 140px; height: 140px; z-index: 0; pointer-events: none;
        }
        .crystal-ball {
            width: 120px; height: 120px; border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.9), rgba(138, 43, 226, 0.2) 40%, rgba(20, 0, 40, 0.6) 90%);
            box-shadow: 0 0 40px rgba(138, 43, 226, 0.4), inset 0 0 20px rgba(138, 43, 226, 0.3);
            animation: pulse 4s ease-in-out infinite; margin: 0 auto;
        }
        .crystal-base {
            width: 80px; height: 20px; background: linear-gradient(90deg, #3e2723, #d4af37, #3e2723);
            border-radius: 50%; margin: -10px auto 0; box-shadow: 0 10px 20px black;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 40px rgba(138, 43, 226, 0.4); }
            50% { transform: scale(1.02); box-shadow: 0 0 60px rgba(138, 43, 226, 0.6); }
        }

        /* ==================== 3. å¡ç‰Œå¸ƒå±€ ==================== */
        .cards-layout {
            display: flex; gap: 40px; margin-top: 180px; padding-bottom: 80px; 
            z-index: 10; flex-wrap: wrap; justify-content: center; width: 100%;
        }

        .card-wrapper {
            width: 280px; height: 460px; position: relative; cursor: pointer;
            transform-style: preserve-3d; transition: transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
            -webkit-tap-highlight-color: transparent;
        }
        .card-wrapper:hover { transform: translateY(-10px); }
        .card-wrapper.flipped { transform: rotateY(180deg); }
        
        .card-wrapper.flipped .back { opacity: 0; transition: opacity 0s linear 0.4s; pointer-events: none; }
        .card-wrapper:not(.flipped) .back { opacity: 1; transition: opacity 0s linear 0s; }

        .face {
            position: absolute; width: 100%; height: 100%; border-radius: 12px;
            -webkit-backface-visibility: hidden; backface-visibility: hidden;
            box-shadow: 0 20px 50px rgba(0,0,0,0.7); overflow: hidden; border: 1px solid #d4af37;
        }

        /* === å¡èƒŒ === */
        .back {
            background-color: #150f1f;
            background-image: 
                linear-gradient(45deg, #150f1f 75%, transparent 75%),
                linear-gradient(135deg, #150f1f 75%, transparent 75%),
                linear-gradient(225deg, #150f1f 75%, transparent 75%),
                linear-gradient(315deg, #150f1f 75%, transparent 75%),
                radial-gradient(circle, #d4af37 2px, transparent 2.5px);
            background-size: 20px 20px, 40px 40px; background-position: 0 0, 20px 20px;
            border: 8px solid #2a1d35; display: flex; justify-content: center; align-items: center; z-index: 2;
        }
        .totem {
            width: 140px; height: 140px; border: 2px solid #d4af37; border-radius: 50%;
            display: flex; justify-content: center; align-items: center; position: relative;
            background: #150f1f; box-shadow: 0 0 20px rgba(212, 175, 55, 0.2);
        }
        .totem::before {
            content: ""; position: absolute; width: 100px; height: 100px;
            border: 2px solid #d4af37; transform: rotate(45deg);
        }
        .totem-symbol { font-size: 50px; color: #d4af37; z-index: 2; text-shadow: 0 0 10px rgba(212, 175, 55, 0.5); }

        /* === æ­£é¢ === */
        .front {
            background: #fdf6e3; transform: rotateY(180deg);
            background-image: url('https://www.transparenttextures.com/patterns/aged-paper.png');
            display: flex; flex-direction: column; border: 6px solid #2a1d35; z-index: 1;
        }
        .front-frame {
            flex: 1; margin: 6px; border: 2px solid #d4af37; padding: 20px;
            position: relative; display: flex; flex-direction: column; align-items: center;
        }
        .ornament { position: absolute; width: 20px; height: 20px; border-top: 3px double #d4af37; border-left: 3px double #d4af37; }
        .tl { top: 4px; left: 4px; } .tr { top: 4px; right: 4px; transform: rotate(90deg); }
        .bl { bottom: 4px; left: 4px; transform: rotate(-90deg); } .br { bottom: 4px; right: 4px; transform: rotate(180deg); }

        h2 {
            font-family: "Noto Serif SC", serif; font-size: 22px; margin: 10px 0; color: #2a1d35;
            border-bottom: 1px solid #d4af37; padding-bottom: 8px; width: 100%; text-align: center; letter-spacing: 2px;
        }

        .magic-btn {
            margin-top: auto; background: transparent; border: 1px solid #2a1d35; padding: 10px 30px;
            font-family: "Noto Serif SC", serif; font-size: 16px; color: #2a1d35; cursor: pointer;
            transition: 0.3s; position: relative; overflow: hidden; -webkit-tap-highlight-color: transparent;
        }
        .magic-btn:hover { background: #2a1d35; color: #d4af37; }

        .result-text {
            font-size: 32px; font-weight: bold; color: #8b0000; min-height: 80px;
            display: flex; align-items: center; justify-content: center; text-align: center; margin-top: 40px;
        }

        .art-box {
            width: 100%; height: 200px; background: #eee; border: 1px solid #2a1d35;
            margin: 10px 0; overflow: hidden; position: relative;
        }
        .art-img { width: 100%; height: 100%; background-size: cover; background-position: center; transition: opacity 0.3s; }
        
        /* éŸ³ä¹å¾‹åŠ¨åŠ¨ç”» */
        .equalizer {
            display: flex; justify-content: center; align-items: flex-end;
            height: 30px; gap: 4px; margin-top: 10px; opacity: 0; transition: opacity 0.5s;
        }
        .bar { width: 6px; background: #d4af37; animation: bounce 1s infinite ease-in-out; }
        .bar:nth-child(1) { height: 10px; animation-delay: 0.1s; }
        .bar:nth-child(2) { height: 20px; animation-delay: 0.3s; }
        .bar:nth-child(3) { height: 15px; animation-delay: 0.2s; }
        .bar:nth-child(4) { height: 25px; animation-delay: 0.4s; }
        .bar:nth-child(5) { height: 12px; animation-delay: 0.1s; }
        @keyframes bounce { 0%, 100% { transform: scaleY(1); } 50% { transform: scaleY(1.5); } }

        .hint {
            position: fixed; bottom: 20px; width: 100%; text-align: center;
            color: rgba(212, 175, 55, 0.4); font-size: 12px; letter-spacing: 2px;
            text-transform: uppercase; pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="nebula-bg"></div>
    <div class="dust"></div>
    <div class="crystal-container"><div class="crystal-ball"></div><div class="crystal-base"></div></div>

    <div class="cards-layout">
        
        <div class="card-wrapper" onclick="flipCard(this, 'fate')">
            <div class="face back"><div class="totem"><div class="totem-symbol">âœ¦</div></div></div>
            <div class="face front">
                <div class="front-frame">
                    <div class="ornament tl"></div><div class="ornament tr"></div><div class="ornament bl"></div><div class="ornament br"></div>
                    <h2>å‘½è¿ä¹‹è½®</h2>
                    <p style="font-size: 13px; color: #666; font-style: italic;">â€œå¿ƒä¸­çš„å›°æƒ‘ï¼Œåœ¨æ­¤æ˜¾ç°â€</p>
                    <div class="result-text" id="fate-text">?</div>
                    <button class="magic-btn" onclick="askDestiny(event)">æ­ç¤ºæŒ‡å¼•</button>
                </div>
            </div>
        </div>

        <div class="card-wrapper" onclick="flipCard(this, 'art')">
            <div class="face back"><div class="totem"><div class="totem-symbol">ğŸ‘</div></div></div>
            <div class="face front">
                <div class="front-frame">
                    <div class="ornament tl"></div><div class="ornament tr"></div><div class="ornament bl"></div><div class="ornament br"></div>
                    <h2>å¼‚ç•Œä¹‹çª—</h2>
                    <div class="art-box"><div class="art-img" id="art-img" style="background-image: url('https://img.paulzzh.com/touhou/random');"></div></div>
                    <div style="text-align: center;">
                        <p style="font-size: 14px; margin: 5px 0;">"å‡è§†æ·±æ¸Š..."</p>
                        <small style="color: #999; font-size: 12px;">ç¿»é¢è‡ªåŠ¨åˆ·æ–°è§‚æµ‹</small>
                    </div>
                </div>
            </div>
        </div>

        <div class="card-wrapper" onclick="flipCard(this, 'noise')">
            <div class="face back"><div class="totem"><div class="totem-symbol">â™«</div></div></div>
            <div class="face front">
                <div class="front-frame">
                    <div class="ornament tl"></div><div class="ornament tr"></div><div class="ornament bl"></div><div class="ornament br"></div>
                    
                    <h2 id="noise-title">å±‹æªç»†é›¨</h2>
                    
                    <div class="art-box" style="height: 180px;">
                        <div class="art-img" id="noise-bg" style="background-image: url('https://images.weserv.nl/?url=https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=600&fit=crop');"></div>
                    </div>
                    
                    <div class="equalizer" id="noise-eq">
                        <div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
                    </div>
                    
                    <div style="font-size: 12px; color: #999; margin-top: 5px;">ç¿»å¼€å³æ’­ Â· æ²»æ„ˆå¿ƒæµ</div>

                    <audio id="audio-player" loop>
                        <source id="audio-source" src="" type="audio/ogg">
                    </audio>
                </div>
            </div>
        </div>

    </div>

    <div class="hint">ç‚¹å‡»å¡ç‰‡ç¿»é¢åˆ·æ–° Â· éŸ³ä¹å¡ç¿»å¼€å³æ’­</div>

    <script>
        // ==================== 0. æ•°æ®æºé…ç½® (ç»å¯¹ç¨³å®šç‰ˆ) ====================
        const sounds = [
            { 
                name: "å±‹æªç»†é›¨", 
                // Google å®˜æ–¹ç¤ºä¾‹éŸ³é¢‘ï¼šéå¸¸æŸ”å’Œçš„é›¨å£°ï¼Œä¸åƒæš´é›¨é‚£ä¹ˆåµ
                audio: "https://actions.google.com/sounds/v1/weather/rain_on_roof.ogg", 
                // Unsplash æŒ‡å®š IDï¼šå¸¦æ°´ç çš„çª—æˆ·ï¼Œéå¸¸åŒ¹é…
                img: "https://images.weserv.nl/?url=https://images.unsplash.com/photo-1493314894560-5c412a56c17c?w=600&fit=crop" 
            },
            { 
                name: "æ—é—´æ¸…æ™¨", 
                // é¸Ÿå«å£°ï¼Œå¾ˆæ¸…è„†ï¼Œæ²¡æœ‰çŒ«å«
                audio: "https://actions.google.com/sounds/v1/nature/forest_morning.ogg", 
                // é˜³å…‰ç©¿è¿‡æ ‘æ—
                img: "https://images.weserv.nl/?url=https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=600&fit=crop" 
            },
            { 
                name: "æ¸©æŸ”æµ·æµª", 
                // åªæœ‰æµªèŠ±å£°ï¼Œæ²¡æœ‰æµ·é¸¥å«
                audio: "https://actions.google.com/sounds/v1/nature/ocean_waves_large_crash.ogg", 
                // æ²™æ»©æµ·æµª
                img: "https://images.weserv.nl/?url=https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=600&fit=crop" 
            },
            { 
                name: "å±±æ¶§æµæ°´", 
                // åªæœ‰æ°´æµå£°
                audio: "https://actions.google.com/sounds/v1/nature/glacier_melt.ogg", 
                // å°æºªæµ
                img: "https://images.weserv.nl/?url=https://images.unsplash.com/photo-1432405972618-c60b0225b8f9?w=600&fit=crop" 
            }
        ];

        // é¢„åŠ è½½ç¬¬ä¸€ä¸ªéŸ³é¢‘
        let currentSound = sounds[0];
        const player = document.getElementById('audio-player');
        const source = document.getElementById('audio-source');
        
        source.src = currentSound.audio;
        player.load(); // é¢„åŠ è½½

        // ==================== 1. ç¿»ç‰Œé€»è¾‘ (è‡ªåŠ¨æ’­æ§) ====================
        function flipCard(card, type) {
            const isFlipped = card.classList.contains('flipped');
            const eq = document.getElementById('noise-eq');

            if (isFlipped) {
                // -> å‡†å¤‡åˆä¸Š
                card.classList.remove('flipped');
                
                // éŸ³ä¹å¡åˆä¸Šï¼šç«‹åˆ»æš‚åœ
                if (type === 'noise') {
                    player.pause();
                    eq.style.opacity = 0; 
                    // 600ms åå·å·åˆ‡æ­Œ
                    setTimeout(() => { refreshData(type); }, 600);
                } else {
                    setTimeout(() => { refreshData(type); }, 600);
                }

            } else {
                // -> å‡†å¤‡ç¿»å¼€
                card.classList.add('flipped');

                // éŸ³ä¹å¡ç¿»å¼€ï¼šå°è¯•æ’­æ”¾
                if (type === 'noise') {
                    player.play().then(() => {
                        eq.style.opacity = 1; 
                    }).catch(e => {
                        console.log("éœ€ç”¨æˆ·äº¤äº’æ‰èƒ½æ’­æ”¾", e);
                    });
                }
            }
        }

        // ==================== 2. æ•°æ®åˆ·æ–°é€»è¾‘ ====================
        function refreshData(type) {
            const ts = new Date().getTime();

            if (type === 'art') {
                document.getElementById('art-img').style.backgroundImage = `url('https://img.paulzzh.com/touhou/random?t=${ts}')`;
            } 
            else if (type === 'fate') {
                const fateText = document.getElementById('fate-text');
                fateText.innerText = "?";
                fateText.style.color = "#8b0000";
            }
            else if (type === 'noise') {
                // éšæœºåˆ‡æ­Œ
                const randomSound = sounds[Math.floor(Math.random() * sounds.length)];
                
                document.getElementById('noise-title').innerText = randomSound.name;
                document.getElementById('noise-bg').style.backgroundImage = `url('${randomSound.img}')`;
                
                // æ›´æ–°éŸ³é¢‘
                source.src = randomSound.audio;
                player.load();
            }
        }

        // ==================== 3. å‘½è¿å åœé€»è¾‘ ====================
        const destinyOptions = ["æ­¤æ—¶è¡ŒåŠ¨", "é™è§‚å…¶å˜", "ç›¸ä¿¡ç›´è§‰", "å¤§åƒä¸€é¡¿", "ç«‹åˆ»ç¡è§‰", "å‡ºé—¨æ•£æ­¥", "å¤ä¹ åŠŸè¯¾", "é‡åˆ·ç•ªå‰§", "åšæŒå·±è§", "è”ç³»è€å‹"];
        function askDestiny(e) {
            e.stopPropagation();
            const textEl = document.getElementById('fate-text');
            let count = 0;
            textEl.style.color = "#8b0000"; textEl.style.transform = "scale(1)";
            const timer = setInterval(() => {
                const randomIndex = Math.floor(Math.random() * destinyOptions.length);
                textEl.innerText = destinyOptions[randomIndex];
                count++;
                if (count >= 15) {
                    clearInterval(timer);
                    textEl.style.color = "#d4af37";
                    textEl.style.transform = "scale(1.2)";
                    textEl.style.transition = "transform 0.2s";
                    setTimeout(() => textEl.style.transform = "scale(1)", 200);
                }
            }, 50);
        }
    </script>
</body>
</html>
